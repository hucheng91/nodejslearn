/** * Created by pc on 2016/5/11. */var MongoClient = require('mongodb').MongoClient;var assert = require('assert');var express = require('express');var app = express();var url = 'mongodb://localhost:27017/test';MongoClient.connect(url, function(err, db) {    assert.equal(null, err);    /*insertDocument(db, function() {        db.close();    });*/    findRestaurants1(db, function() {        console.log("/!*******...........................................................................*******!/")         findRestaurants2(db, function() {             console.log("/!*******...........................................................................*******!/")             findRestaurants3(db,function(){                 db.close();             });         });    });});app.listen(8888);//insertOne()插入数据var insertDocument = function(db, callback) {    db.collection('restaurants').insertOne( {        "address" : {            "street" : "3Avenue",            "zipcode" : "10075",            "building" : "1480",            "coord" : [ -73.9557413, 40.7720266 ]        },        "borough" : "Manhattan3",        "cuisine" : "Italian3",        "grades" : [            {                "date" : new Date("2014-10-01T00:00:00Z"),                "grade" : "A",                "score" : 11            },            {                "date" : new Date("2014-01-16T00:00:00Z"),                "grade" : "B",                "score" : 17            }        ],        "name" : "Vella",        "restaurant_id" : "41704620"    }, function(err, result) {        assert.equal(err, null);        console.log("Inserted a document into the restaurants collection.");        callback();    });};// find()方法使用var findRestaurants1 = function(db, callback) {    var cursor =db.collection('restaurants').find( );    cursor.each(function(err, doc) {        assert.equal(err, null);        if (doc != null) {            console.dir(doc);        } else {            callback();        }    });};/*** * 条件查询 find({ "borough": "Manhattan" }) */var findRestaurants2 = function(db,callback){    var cursor = db.collection("restaurants").find({ "borough": "Manhattan" });    cursor.each(function(err,doc){        assert.equal(err, null);        if (doc != null) {            console.dir(doc);        } else {            callback();        }    });}/*** *{ $gt: 30 } */var findRestaurants3 = function(db, callback) {    var cursor =db.collection('restaurants').find( { "grades.score": { $gt: 30 } } );    cursor.each(function(err, doc) {        assert.equal(err, null);        if (doc != null) {            console.dir(doc);        } else {            callback();        }    });};